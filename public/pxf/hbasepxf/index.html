<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Accessing HBase Data - Pivotal HDB</title>
    <meta name="generator" content="Hugo 0.36.1" />

    
    <link rel="canonical" href="https://example.org/pxf/hbasepxf/">
    

    <meta property="og:url" content="https://example.org/pxf/hbasepxf/">
    <meta property="og:title" content="Pivotal HDB">
    <meta property="og:image" content="https://example.org/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Pivotal HDB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://example.org/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://example.org/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://example.org/fonts/icon.eot');
        src: url('https://example.org/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://example.org/fonts/icon.woff')
               format('woff'),
             url('https://example.org/fonts/icon.ttf')
               format('truetype'),
             url('https://example.org/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://example.org/stylesheets/application.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://example.org/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-teal palette-accent-deep orange">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Accessing HBase Data
      </div>
    </div>

    

    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://example.org/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://example.org/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Pivotal HDB <span class="version">1.0.0</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Ambari Administration" href="https://example.org/admin/ambari-admin">
	
	Ambari Administration
</a>



  
</li>



<li>
  
    



<a  title="Ddls" href="https://example.org/ddl/">
	
	Ddls
</a>



  
</li>



<li>
  
    



<a  title="Managing Client Access" href="https://example.org/clientaccess/">
	
	Managing Client Access
</a>



  
</li>



<li>
  
    



<a  title="Pivotal HDB Docs" href="https://example.org/">
	
	Pivotal HDB Docs
</a>



  
</li>



<li>
  
    



<a  title="Plexts" href="https://example.org/plext/">
	
	Plexts
</a>



  
</li>



<li>
  
    



<a  title="Pxfs" href="https://example.org/pxf/">
	
	Pxfs
</a>



  
</li>



<li>
  
    



<a  title="Queries" href="https://example.org/query/">
	
	Queries
</a>



  
</li>



<li>
  
    



<a  title="Requirements" href="https://example.org/requirements/">
	
	Requirements
</a>



  
</li>



<li>
  
    



<a  title="Troubleshootings" href="https://example.org/troubleshooting/">
	
	Troubleshootings
</a>



  
</li>



<li>
  
    



<a  title="Tutorials" href="https://example.org/tutorial/">
	
	Tutorials
</a>



  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Accessing HBase Data </h1>

			

<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<h2 id="a-id-installingthepxfhbaseplugin-a-prerequisites"><a id="installingthepxfhbaseplugin"></a>Prerequisites</h2>

<p>Before trying to access HBase data with PXF, verify the following:</p>

<ul>
<li><p>The <code>/etc/hbase/conf/hbase-env.sh</code> configuration file must reference the <code>pxf-hbase.jar</code>. For example, <code>/etc/hbase/conf/hbase-env.sh</code> should include the line:</p>

<pre><code class="language-bash">export HBASE_CLASSPATH=${HBASE_CLASSPATH}:/usr/lib/pxf/pxf-hbase.jar
</code></pre>

<p><strong>Note:</strong> You must restart HBase after making any changes to the HBase configuration.</p></li>

<li><p>PXF HBase plug-in is installed on all cluster nodes.</p></li>

<li><p>HBase and ZooKeeper jars are installed on all cluster nodes.</p></li>
</ul>

<h2 id="a-id-syntax3-a-syntax"><a id="syntax3"></a>Syntax</h2>

<p>To create an external HBase table, use the following syntax:</p>

<pre><code class="language-sql">CREATE READABLE EXTERNAL TABLE table_name 
    ( column_name data_type [, ...] | LIKE other_table )
LOCATION ('pxf://host[:port]/hbase-table-name?Profile=HBase')
FORMAT 'CUSTOM' (Formatter='pxfwritable_import');
</code></pre>

<p>The HBase profile is equivalent to the following PXF parameters:</p>

<ul>
<li>Fragmenter=org.apache.hawq.pxf.plugins.hbase.HBaseDataFragmenter</li>
<li>Accessor=org.apache.hawq.pxf.plugins.hbase.HBaseAccessor</li>
<li>Resolver=org.apache.hawq.pxf.plugins.hbase.HBaseResolver</li>
</ul>

<p><strong>Note</strong>: The <code>ANALYZE</code> command is not supported on external tables you create with the <code>HBase</code> profile.</p>

<h2 id="a-id-columnmapping-a-column-mapping"><a id="columnmapping"></a>Column Mapping</h2>

<p>Most HAWQ external tables (PXF or others) require that the HAWQ table attributes match the source data record layout, and include all the available attributes. With HAWQ, however, you use the PXF HBase plug-in to specify the subset of HBase qualifiers that define the HAWQ PXF table. To set up a clear mapping between each attribute in the PXF table and a specific qualifier in the HBase table, you can use either direct mapping or indirect mapping. In addition, the HBase row key is handled in a special way.</p>

<h3 id="a-id-rowkey-a-row-key"><a id="rowkey"></a>Row Key</h3>

<p>You can use the HBase table row key in several ways. For example, you can see them using query results, or you can run a WHERE clause filter on a range of row key values. To use the row key in the HAWQ query, define the HAWQ table with the reserved PXF attribute <code>recordkey.</code> This attribute name tells PXF to return the record key in any key-value based system and in HBase.</p>

<p><strong>Note:</strong> Because HBase is byte and not character-based, you should define the recordkey as type bytea. This may result in better ability to filter data and increase performance.</p>

<pre><code class="language-sql">CREATE EXTERNAL TABLE &lt;tname&gt; (recordkey bytea, ... ) LOCATION ('pxf:// ...')
</code></pre>

<h3 id="a-id-directmapping-a-direct-mapping"><a id="directmapping"></a>Direct Mapping</h3>

<p>Use Direct Mapping to map HAWQ table attributes to HBase qualifiers. You can specify the HBase qualifier names of interest, with column family names included, as quoted values. </p>

<p>For example, you have defined an HBase table called <code>hbase_sales</code> with multiple column families and many qualifiers. To create a HAWQ table with these attributes:</p>

<ul>
<li><code>rowkey</code></li>
<li>qualifier <code>saleid</code> in the column family <code>cf1</code></li>
<li>qualifier <code>comments</code> in the column family <code>cf8</code> </li>
</ul>

<p>use the following <code>CREATE EXTERNAL TABLE</code> syntax:</p>

<pre><code class="language-sql">CREATE EXTERNAL TABLE hbase_sales (
  recordkey bytea,
  &quot;cf1:saleid&quot; int,
  &quot;cf8:comments&quot; varchar
) ...
</code></pre>

<p>The PXF HBase plug-in uses these attribute names as-is and returns the values of these HBase qualifiers.</p>

<h3 id="a-id-indirectmappingvialookuptable-a-indirect-mapping-via-lookup-table"><a id="indirectmappingvialookuptable"></a>Indirect Mapping (via Lookup Table)</h3>

<p>The direct mapping method is fast and intuitive, but using indirect mapping helps to reconcile HBase qualifier names with HAWQ behavior:</p>

<ul>
<li>HBase qualifier names may be longer than 32 characters. HAWQ has a 32-character limit on attribute name size.</li>
<li>HBase qualifier names can be binary or non-printable. HAWQ attribute names are character based.</li>
</ul>

<p>In either case, Indirect Mapping uses a lookup table on HBase. You can create the lookup table to store all necessary lookup information. This works as a template for any future queries. The name of the lookup table must be <code>pxflookup</code> and must include the column family named <code>mapping</code>.</p>

<p>Using the sales example in Direct Mapping, if our <code>rowkey</code> represents the HBase table name and the <code>mapping</code> column family includes the actual attribute mapping in the key value form of<code>&lt;hawq attr name&gt;=&lt;hbase                             cf:qualifier&gt;</code>.</p>

<h4 id="a-id-example5-a-example"><a id="example5"></a>Example</h4>

<p>This example maps the <code>saleid</code> qualifier in the <code>cf1</code> column family to the HAWQ <code>id</code> column and the <code>comments</code> qualifier in the <code>cf8</code> family to the HAWQ <code>cmts</code> column.</p>

<table>
<thead>
<tr>
<th>(row key)</th>
<th>mapping</th>
</tr>
</thead>

<tbody>
<tr>
<td>sales</td>
<td>id=cf1:saleid</td>
</tr>

<tr>
<td>sales</td>
<td>cmts=cf8:comments</td>
</tr>
</tbody>
</table>

<p>The mapping assigned new names for each qualifier. You can use these names in your HAWQ table definition:</p>

<pre><code class="language-sql">CREATE EXTERNAL TABLE hbase_sales (
  recordkey bytea
  id int,
  cmts varchar
) ...
</code></pre>

<p>PXF automatically matches HAWQ to HBase column names when a <code>pxflookup</code> table exists in HBase.</p>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://example.org/pxf/jdbcpxf/" title="Accessing External SQL Databases with JDBC (Beta)">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Accessing External SQL Databases with JDBC (Beta)
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://example.org/pxf/hdfsfiledatapxf/" title="Accessing HDFS File Data">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Accessing HDFS File Data
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://example.org/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

