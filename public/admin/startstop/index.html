<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Starting and Stopping HAWQ - Pivotal HDB</title>
    <meta name="generator" content="Hugo 0.36.1" />

    
    <link rel="canonical" href="https://example.org/admin/startstop/">
    

    <meta property="og:url" content="https://example.org/admin/startstop/">
    <meta property="og:title" content="Pivotal HDB">
    <meta property="og:image" content="https://example.org/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Pivotal HDB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://example.org/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://example.org/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://example.org/fonts/icon.eot');
        src: url('https://example.org/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://example.org/fonts/icon.woff')
               format('woff'),
             url('https://example.org/fonts/icon.ttf')
               format('truetype'),
             url('https://example.org/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://example.org/stylesheets/application.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://example.org/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-teal palette-accent-deep orange">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Starting and Stopping HAWQ
      </div>
    </div>

    

    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://example.org/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://example.org/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Pivotal HDB <span class="version">1.0.0</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Ambari Administration" href="https://example.org/admin/ambari-admin">
	
	Ambari Administration
</a>



  
</li>



<li>
  
    



<a  title="Ddls" href="https://example.org/ddl/">
	
	Ddls
</a>



  
</li>



<li>
  
    



<a  title="Managing Client Access" href="https://example.org/clientaccess/">
	
	Managing Client Access
</a>



  
</li>



<li>
  
    



<a  title="Pivotal HDB Docs" href="https://example.org/">
	
	Pivotal HDB Docs
</a>



  
</li>



<li>
  
    



<a  title="Plexts" href="https://example.org/plext/">
	
	Plexts
</a>



  
</li>



<li>
  
    



<a  title="Pxfs" href="https://example.org/pxf/">
	
	Pxfs
</a>



  
</li>



<li>
  
    



<a  title="Queries" href="https://example.org/query/">
	
	Queries
</a>



  
</li>



<li>
  
    



<a  title="Requirements" href="https://example.org/requirements/">
	
	Requirements
</a>



  
</li>



<li>
  
    



<a  title="Troubleshootings" href="https://example.org/troubleshooting/">
	
	Troubleshootings
</a>



  
</li>



<li>
  
    



<a  title="Tutorials" href="https://example.org/tutorial/">
	
	Tutorials
</a>



  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Starting and Stopping HAWQ </h1>

			

<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<p>In a HAWQ DBMS, the database server instances (the master and all segments) are started or stopped across all of the hosts in the system in such a way that they can work together as a unified DBMS.</p>

<p>Because a HAWQ system is distributed across many machines, the process for starting and stopping a HAWQ system is different than the process for starting and stopping a regular PostgreSQL DBMS.</p>

<p>Use the <code>hawq start</code><em><code>object</code></em> and <code>hawq stop</code><em><code>object</code></em> commands to start and stop HAWQ, respectively. These management tools are located in the <code>$GPHOME/bin</code> directory on your HAWQ master host.</p>

<p>Initializing a HAWQ system also starts the system.</p>

<p><strong>Important:</strong></p>

<p>Do not issue a <code>KILL</code> command to end any Postgres process. Instead, use the database command <code>pg_cancel_backend()</code>.</p>

<p>For information about <a href="../reference/cli/admin_utilities/hawqstart.html">hawq start</a> and <a href="../reference/cli/admin_utilities/hawqstop.html">hawq stop</a>, see the appropriate pages in the HAWQ Management Utility Reference or enter <code>hawq start -h</code> or <code>hawq stop -h</code> on the command line.</p>

<h2 id="a-id-task-hkd-gzv-fp-a-starting-hawq"><a id="task_hkd_gzv_fp"></a>Starting HAWQ</h2>

<p>When a HAWQ system is first initialized, it is also started. For more information about initializing HAWQ, see <a href="../reference/cli/admin_utilities/hawqinit.html">hawq init</a>.</p>

<p>To start a stopped HAWQ system that was previously initialized, run the <code>hawq start</code> command on the master instance.</p>

<p>You can also use the <code>hawq start master</code> command to start only the HAWQ master, without segment nodes, then add these later, using <code>hawq start segment</code>. If you want HAWQ to ignore hosts that fail ssh validation, use the hawq start <code>--ignore-bad-hosts</code> option.</p>

<p>Use the <code>hawq start cluster</code> command to start a HAWQ system that has already been initialized by the <code>hawq init cluster</code> command, but has been stopped by the <code>hawq stop cluster</code> command. The <code>hawq start cluster</code> command starts a HAWQ system on the master host and starts all its segments. The command orchestrates this process and performs the process in parallel.</p>

<h2 id="a-id-task-gpdb-restart-a-restarting-hawq"><a id="task_gpdb_restart"></a>Restarting HAWQ</h2>

<p>Stop the HAWQ system and then restart it.</p>

<p>The <code>hawq restart</code> command with the appropriate <code>cluster</code> or node-type option will stop and then restart HAWQ after the shutdown completes. If the master or segments are already stopped, restart will have no effect.</p>

<ul>
<li><p>To restart a HAWQ cluster, enter the following command on the master host:</p>

<pre><code class="language-shell">$ hawq restart cluster
</code></pre></li>
</ul>

<h2 id="a-id-task-upload-config-a-reloading-configuration-file-changes-only"><a id="task_upload_config"></a>Reloading Configuration File Changes Only</h2>

<p>Reload changes to the HAWQ configuration files without interrupting the system.</p>

<p>The <code>hawq stop</code> command can reload changes to the <code>pg_hba.conf</code>configuration file and to <em>runtime</em> parameters in the <code>hawq-site.xml</code> and <code>pg_hba.conf</code> files without service interruption. Active sessions pick up changes when they reconnect to the database. Many server configuration parameters require a full system restart (<code>hawq restart cluster</code>) to activate. For information about server configuration parameters, see the <a href="../reference/guc/guc_config.html">Server Configuration Parameter Reference</a>.</p>

<ul>
<li><p>Reload configuration file changes without shutting down the system using the <code>hawq stop</code> command:</p>

<pre><code class="language-shell">$ hawq stop cluster --reload
</code></pre>

<p>Or:</p>

<pre><code class="language-shell">$ hawq stop cluster -u
</code></pre></li>
</ul>

<h2 id="a-id-task-maint-mode-a-starting-the-master-in-maintenance-mode"><a id="task_maint_mode"></a>Starting the Master in Maintenance Mode</h2>

<p>Start only the master to perform maintenance or administrative tasks without affecting data on the segments.</p>

<p>Maintenance mode is a superuser-only mode that should only be used when required for a particular maintenance task. For example, you can connect to a database only on the master instance in maintenance mode and edit system catalog settings.</p>

<ol>
<li><p>Run <code>hawq start</code> on the <code>master</code> using the <code>-m</code> option:</p>

<pre><code class="language-shell">$ hawq start master -m
</code></pre></li>

<li><p>Connect to the master in maintenance mode to do catalog maintenance. For example:</p>

<pre><code class="language-shell">$ PGOPTIONS='-c gp_session_role=utility' psql template1
</code></pre></li>

<li><p>After completing your administrative tasks, restart the master in production mode.</p>

<pre><code class="language-shell">$ hawq restart master 
</code></pre>

<p><strong>Warning:</strong></p>

<p>Incorrect use of maintenance mode connections can result in an inconsistent HAWQ system state. Only expert users should perform this operation.</p></li>
</ol>

<h2 id="a-id-task-gpdb-stop-a-stopping-hawq"><a id="task_gpdb_stop"></a>Stopping HAWQ</h2>

<p>The <code>hawq stop cluster</code> command stops or restarts your HAWQ system and always runs on the master host. When activated, <code>hawq stop cluster</code> stops all <code>postgres</code> processes in the system, including the master and all segment instances. The <code>hawq stop cluster</code> command uses a default of up to 64 parallel worker threads to bring down the segments that make up the HAWQ cluster. The system waits for any active transactions to finish before shutting down. To stop HAWQ immediately, use fast mode. The commands <code>hawq stop master</code>, <code>hawq stop segment</code>, <code>hawq stop standby</code>, or <code>hawq stop allsegments</code> can be used to stop the master, the local segment node, standby, or all segments in the cluster. Stopping the master will stop only the master segment, and will not shut down a cluster.</p>

<ul>
<li><p>To stop HAWQ:</p>

<pre><code class="language-shell">$ hawq stop cluster
</code></pre></li>

<li><p>To stop HAWQ in fast mode:</p>

<pre><code class="language-shell">$ hawq stop cluster -M fast
</code></pre></li>
</ul>

<h2 id="a-id-task-tx4-bl3-h5-a-best-practices-to-start-stop-hawq-cluster-members"><a id="task_tx4_bl3_h5"></a>Best Practices to Start/Stop HAWQ Cluster Members</h2>

<p>For best results in using <code>hawq start</code> and <code>hawq stop</code> to manage your HAWQ system, the following best practices are recommended.</p>

<ul>
<li><p>Issue the <code>CHECKPOINT</code> command to update and flush all data files to disk and update the log file before stopping the cluster. A checkpoint ensures that, in the event of a crash, files can be restored from the checkpoint snapshot.</p></li>

<li><p>Stop the entire HAWQ system by stopping the cluster on the master host.</p>

<pre><code class="language-shell">$ hawq stop cluster
</code></pre></li>

<li><p>To stop segments and kill any running queries without causing data loss or inconsistency issues, use <code>fast</code> or <code>immediate</code> mode on the cluster:</p>

<pre><code class="language-shell">$ hawq stop cluster -M fast
$ hawq stop cluster -M immediate
</code></pre></li>

<li><p>Use <code>hawq stop master</code> to stop the master only. If you cannot stop the master due to running transactions, try using <code>fast</code> shutdown. If <code>fast</code> shutdown does not work, use <code>immediate</code> shutdown. Use <code>immediate</code> shutdown with caution, as it will result in a crash-recovery run when the system is restarted.</p>

<pre><code class="language-shell">$ hawq stop master -M fast
$ hawq stop master -M immediate
</code></pre></li>

<li><p>If you have changed or want to reload server parameter settings on a HAWQ database where there are active connections, use the command:</p>

<pre><code class="language-shell">$ hawq stop master -u -M fast 
</code></pre></li>

<li><p>When stopping a segment or all segments, use <code>smart</code> mode, which is the default. Using <code>fast</code> or <code>immediate</code> mode on segments will have no effect since segments are stateless.</p>

<pre><code class="language-shell">$ hawq stop segment
$ hawq stop allsegments
</code></pre></li>

<li><p>You should typically always use <code>hawq start cluster</code> or <code>hawq restart cluster</code> to start the cluster. If you do end up starting nodes individually with <code>hawq start standby|master|segment</code>, make sure to always start the standby <em>before</em> the active master. Otherwise, the standby can become unsynchronized with the active master.</p></li>
</ul>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://example.org/install/" title="Select HAWQ Host Machines">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Select HAWQ Host Machines
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://example.org/ddl/ddl-storage/" title="Table Storage Model and Distribution Policy">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Table Storage Model and Distribution Policy
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://example.org/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

